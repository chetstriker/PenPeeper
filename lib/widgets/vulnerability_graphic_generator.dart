import 'package:flutter/material.dart';
import 'package:pdf/widgets.dart' as pw;
import 'graphics/graphic_data_models.dart';
import 'graphics/flutter_graphics.dart';
import 'graphics/pdf_graphics.dart';

export 'graphics/graphic_data_models.dart';
export 'graphics/graphic_colors.dart';

/// Main widget that generates vulnerability graphics based on option selected
class VulnerabilityGraphicGenerator extends StatelessWidget {
  final int option;
  final List<VulnerabilityEntry> data;
  final double width;
  final double height;

  const VulnerabilityGraphicGenerator({
    super.key,
    required this.option,
    required this.data,
    this.width = 800,
    this.height = 400,
  });

  static pw.Widget generatePdfWidget({
    required int option,
    required List<VulnerabilityEntry> data,
    double width = 800,
    double height = 400,
  }) {
    switch (option) {
      case 1: return PdfRadialChart.build(data, width, height);
      case 2: return PdfStackedBars.build(data, width, height);
      case 3: return PdfTreemap.build(data, width, height);
      case 4: return PdfHeatmapMatrix.build(data, width, height);
      case 5: return PdfCompactCards.build(data, width, height);
      case 6: return PdfHorizontalFlow.build(data, width, height);
      default:
        return pw.Container(
          width: width,
          height: height,
          alignment: pw.Alignment.center,
          child: pw.Text('Invalid option. Please choose 1-6.'),
        );
    }
  }

  @override
  Widget build(BuildContext context) {
    return Container(
      width: width,
      height: height,
      color: Colors.white,
      child: _buildGraphic(),
    );
  }

  Widget _buildGraphic() {
    switch (option) {
      case 1: return RadialChartGraphic(data: data);
      case 2: return StackedBarsGraphic(data: data);
      case 3: return TreemapGraphic(data: data);
      case 4: return HeatmapMatrixGraphic(data: data);
      case 5: return CompactCardsGraphic(data: data);
      case 6: return HorizontalFlowGraphic(data: data);
      default:
        return Center(
          child: Text(
            'Invalid option. Please choose 1-6.',
            style: TextStyle(fontSize: 16, color: Colors.red),
          ),
        );
    }
  }
}
